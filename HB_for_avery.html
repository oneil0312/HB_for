<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>靖彤生日網頁</title>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Bangers&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles_happybirthday.css">
</head>
<body>
	
	<img src="IMG/brachiosaurus.png" alt="Brachiosaurus" id="brachiosaurus-right" class="dino">
	<img src="IMG/brachiosaurus.png" alt="Brachiosaurus" id="brachiosaurus-left" class="dino">


	<div id="dialog" class="dialog hidden">
		<div class="dialog-content">
			<span class="close">&times;</span>
			<p class="greeting">嗨！我是 <span class="brachio">Brachio</span>，</p>
			<p class="birthday-message"> <span class="birthday-name">靖彤</span> 生日快樂！</p>
		</div>
	</div>


    <header>
        <h1>
            <span class="name">🎈 靖彤 </span>
            <span class="celebration">生日快樂 🎈</span>
        </h1>       
    </header>   
    
    <main>
			<!-- 添加滚动的图片 -->
		<div class="animation-container">
			<img src="IMG/volleyball_kuroo.png" alt="滚动图片" class="animate" id="movingImage1">
			<img src="IMG/volleyball_kenma.png" alt="滚动图片" class="animate" id="movingImage2">
			<img src="IMG/volleyball_shoyo.png" alt="滚动图片" class="animate" id="movingImage3">
			<img src="IMG/volleyball_kageyama.png" alt="滚动图片" class="animate" id="movingImage4">
			<img src="IMG/volleyball_ushijima.png" alt="滚动图片" class="animate" id="movingImage5">
			<img src="IMG/volleyball_goshiki.png" alt="滚动图片" class="animate" id="movingImage6">
			<img src="IMG/volleyball_osamu.png" alt="滚动图片" class="animate" id="movingImage7">
			<img src="IMG/volleyball_suna.png" alt="滚动图片" class="animate" id="movingImage8">
			<img src="IMG/volleyball_atsuma.png" alt="滚动图片" class="animate" id="movingImage9">
			<img src="IMG/volleyball_kita.png" alt="滚动图片" class="animate" id="movingImage10">
			<img src="IMG/volleyball_yaku.png" alt="滚动图片" class="animate" id="movingImage11">
			<img src="IMG/volleyball_nishinoya.png" alt="滚动图片" class="animate" id="movingImage12">
			<img src="IMG/volleyball_aone.png" alt="滚动图片" class="animate" id="movingImage13">
			<img src="IMG/volleyball_Koganegawa.png" alt="滚动图片" class="animate" id="movingImage14">
			<img src="IMG/volleyball_asahi.png" alt="滚动图片" class="animate" id="movingImage15">
			<img src="IMG/volleyball_atsuma.png" alt="滚动图片" class="animate" id="movingImage16">
			<img src="IMG/volleyball_bokuto.png" alt="滚动图片" class="animate" id="movingImage17">
			<img src="IMG/volleyball_oikawa.png" alt="滚动图片" class="animate" id="movingImage18">			
		</div>
            <section id="cake-section">
                <img src="IMG/birthdaycake.jpg" alt="生日蛋糕" class="cake" loading="lazy" />
                <div class="candles">
                    <img src="IMG/candle_unburn.png" alt="未點燃的蠟燭" class="candle" />
                    <img src="IMG/candle_unburn.png" alt="未點燃的蠟燭" class="candle" />
                    <img src="IMG/candle_unburn.png" alt="未點燃的蠟燭" class="candle" />
                </div>
                <div class="wish-container"> 
                    <button id="wish-button" class="hidden">許願</button>
                    <div id="wish-message" class="hidden">請許下今年的心願</div>
                </div>
            </section>


			<section id="birthday-flower-section">
				<div id="card-container" class="card-container">
					<div id="card" class="card">
						<div class="card-back">
							<p>生日花</p>
							<img src="IMG/talocard.png" alt="卡背" class="card-image-back">
						</div>
						<div class="card-front">
							<p>每個人出生那天</p>
							<p>都有一朵花為他盛開</p>
							<img src="IMG/1208card.png" alt="卡正" class="card-image-front">                                 
						</div>
					</div>
				</div>
			</section>


            <section id="input-section">
                <label for="hint-input">請輸入前幾天收集到的提示：</label>
                <input type="text" id="hint-input" placeholder="輸入提示字" aria-label="提示字輸入框">
                <button id="confirm-button">確認</button>
                <div id="result-message" class="hidden" aria-live="polite"></div>
                <img id="qr-code" class="hidden" src="IMG/RickRoll.jpg" alt="QR Code" loading="lazy" />
            </section>
            
            <div id="fireworks-container" class="hidden"></div>
            <div id="speech-bubble-container" ></div>

    </main>





    <footer>
        <p>© 歐尼歐版權大概吧</p>
    </footer>

    <script>	
// 所有图片的 ID
const allImages = [
    'movingImage1', 'movingImage2', 'movingImage3', 'movingImage4', 'movingImage5', 
    'movingImage6', 'movingImage7', 'movingImage8', 'movingImage9', 'movingImage10', 
    'movingImage11', 'movingImage12', 'movingImage13', 'movingImage14', 'movingImage15', 
    'movingImage16', 'movingImage17', 'movingImage18'
];

// 定义全局变量
let images = []; // 当前的图片组
const occupiedPositionsGroup = [
    new Set(), // 第一组的占位
    new Set(), // 第二组的占位
    new Set()  // 第三组的占位
];

// 随机选择六张图片的函数
function getRandomImages(images, num) {
    const selectedImages = [];
    const imageSet = new Set();

    while (imageSet.size < num) {
        const randomIndex = Math.floor(Math.random() * images.length);
        imageSet.add(images[randomIndex]);
    }
    return Array.from(imageSet);
}

// 更新显示的图片
function updateDisplayedImages() {
    const selectedImages = getRandomImages(allImages, 6);
    selectedImages.forEach(imageId => {
        const image = document.getElementById(imageId);
        if (image) image.style.display = 'block'; // 显示选中的图片
    });

    allImages.forEach(imageId => {
        if (!selectedImages.includes(imageId)) {
            const image = document.getElementById(imageId);
            if (image) image.style.display = 'none'; // 隐藏未选中的图片
        }
    });

    images = [ // 使用全局变量
        [selectedImages[0], selectedImages[1]], // 第一组
        [selectedImages[2], selectedImages[3]], // 第二组
        [selectedImages[4], selectedImages[5]]  // 第三组
    ];

    images.forEach((imageGroup, index) => {
        const groupClass = `group${index + 1}`;
        imageGroup.forEach(imageId => {
            const image = document.getElementById(imageId);
            if (image) image.classList.add('animate', groupClass);
        });
    });

    images.forEach((imageGroup, index) => {
        updateImagePositions(imageGroup, occupiedPositionsGroup[index]);
    });
}

// 随机设置图片的垂直位置
function setRandomVerticalPosition(imageId, occupiedPositions) {
    const image = document.getElementById(imageId);
    const imageHeight = 300; // 假设图片的高度是300px
    let randomPosition;

    // 修改这里的范围，以允许更大的垂直位置生成
    const maxPosition = window.innerHeight - imageHeight; // 最大位置
    const minPosition = 50; // 最小位置，向下移动的基准值，可以根据需要进行调整

    do {
        // 生成的随机位置范围扩大至整个视口加上图片高度
        randomPosition = Math.random() * (maxPosition - minPosition) + minPosition;
    } while (Array.from(occupiedPositions).some(pos => Math.abs(pos - randomPosition) < imageHeight));

    image.style.top = randomPosition + 'px'; // 设置图片的顶部位置
    occupiedPositions.add(randomPosition); // 将新位置添加到已占用位置集合
}

// 更新一组图像的位置
function updateImagePositions(imageGroup, occupiedPositions) {
    occupiedPositions.clear(); // 清空当前组的占用位置

    imageGroup.forEach(imageId => {
        setRandomVerticalPosition(imageId, occupiedPositions);
    });

    console.log(`当前组的垂直位置:`, Array.from(occupiedPositions)); // 输出当前组的垂直位置
}

// 初始设置
updateDisplayedImages(); // 生成初始的图像组并更新位置

// 定时器更新位置
setInterval(() => {
    // 更新第一组和第二组的位置
    updateImagePositions(images[0], occupiedPositionsGroup[0]); // 更新第一组
    updateImagePositions(images[1], occupiedPositionsGroup[1]); // 更新第二组
}, 4000); // 4000 毫秒 = 4 秒

setInterval(() => {
    // 更新第三组的位置
    updateImagePositions(images[2], occupiedPositionsGroup[2]); // 更新第三组
}, 6000); // 6000 毫秒 = 6 秒

// 每隔 12 秒更新显示的六张图片
setInterval(() => {
    updateDisplayedImages();
}, 12000); // 12000 毫秒 = 12 秒










	
	
	
        const confirmButton = document.getElementById('confirm-button');
        const hintInput = document.getElementById('hint-input');
        const resultMessage = document.getElementById('result-message');
        let litCandles = 0; // 紀錄已點亮的蠟燭數量

        confirmButton.addEventListener('click', function() {
            const userInput = hintInput.value.trim().toLowerCase();
            if (userInput === 'regalo') {
                resultMessage.textContent = '正確！請截圖兌換禮物或是掃QR碼';
                resultMessage.className = 'success'; // 顯示成功樣式
                document.getElementById('qr-code').classList.remove('hidden'); // 顯示QR碼
            } else {
                resultMessage.textContent = '錯誤！請再試一次。';
                resultMessage.className = 'error'; // 顯示錯誤樣式
                document.getElementById('qr-code').classList.add('hidden'); // 隱藏QR碼
            }
            resultMessage.classList.remove('hidden');
            hintInput.value = ''; // 清空輸入框
        });

        // 使用事件委派，綁定到父元素
        document.querySelector('.candles').addEventListener('mouseover', function(e) {
            if (e.target.classList.contains('candle')) {
                lightCandle(e.target);
            }
        });

        function lightCandle(candle) {
            if (candle.src.includes('candle_unburn.png')) {
                candle.src = 'IMG/candle.png'; // 更換為點燃的蠟燭圖片
                litCandles++;
                if (litCandles === 3) { // 當所有蠟燭點亮時，顯示許願按鈕
                    document.getElementById('wish-button').classList.remove('hidden');
                    // 調整提示區域的位置
                    document.getElementById('input-section').style.marginTop = '50px'; // 可以根據需要調整
                }
            }
        }

        document.getElementById("wish-button").addEventListener("click", () => {
            makeWish();
            document.getElementById("fireworks-container").classList.remove("hidden");
            createFireworks();
            createSpeechBubble(); // 生成對話框
        });

        function makeWish() {
            // 點下許願按鈕後顯示訊息，並在10秒後熄滅蠟燭
            document.getElementById('wish-message').classList.remove('hidden');
            setTimeout(extinguishCandles, 10000); // 10秒後熄滅蠟燭
        }

        function extinguishCandles() {
            const candles = document.querySelectorAll('.candle');
            candles.forEach(candle => {
                candle.src = 'IMG/candle_unburn.png'; // 更換回未點燃的蠟燭圖片
            });
            // 隱藏許願按鈕和訊息，重置已點亮的蠟燭數量
            document.getElementById('wish-button').classList.add('hidden');
            document.getElementById('wish-message').classList.add('hidden');
            litCandles = 0;
            document.getElementById('input-section').style.marginTop = '0'; // 重置 margin
        }

        function createFireworks() {
            const container = document.getElementById("fireworks-container");

            // 煙火效果生成
            for (let i = 0; i < 30; i++) { // 可以調整煙火的顆數
                const firework = document.createElement("div");
                firework.classList.add("firework");

                // 隨機位置
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;

                // 隨機顏色和大小
                const size = Math.random() * 20 + 10; // 大小範圍：10px 到 30px
                const color = `hsl(${Math.random() * 360}, 100%, 50%)`;
                
                firework.style.left = `${x}px`;
                firework.style.top = `${y}px`;
                firework.style.width = `${size}px`;
                firework.style.height = `${size}px`;
                firework.style.backgroundColor = color;
                
                container.appendChild(firework);

                // 動畫時間隨機化
                firework.style.animationDuration = `${Math.random() * 1 + 0.5}s`; // 時間範圍：0.5s 到 1.5s

                // 動畫結束後移除元素
                firework.addEventListener("animationend", () => {
                    firework.remove();
                });
            }

            // 5 秒後隱藏煙火容器
            setTimeout(() => {
                container.classList.add("hidden");
            }, 2000);
        }
		
		
		
const card = document.getElementById('card');

card.addEventListener('click', function () {
    // 切換翻轉效果
    this.classList.toggle('flipped');
});


window.addEventListener('load', () => {
    createSpeechBubble(); // 頁面加載後自動生成對話框
});

function createSpeechBubble() {
    const container = document.getElementById("speech-bubble-container");
    const phrases = ["Boom!", "生日快樂!", "생일축하합니다!", "Happy Birthday!", "お誕生日おめでと", "Surprise!"];
    
    const interval = setInterval(() => {
        const bubble = document.createElement("div");
        bubble.classList.add("speech-bubble");

        // 隨機選擇對話框內容
        const phrase = phrases[Math.floor(Math.random() * phrases.length)];
        bubble.textContent = phrase;

        // 隨機選擇對話框出現的側邊
        const side = Math.random() < 0.5 ? 'left' : 'right';
        const x = side === 'left' ? Math.random() * (window.innerWidth / 2) : Math.random() * (window.innerWidth / 2) + (window.innerWidth / 2);
        const y = Math.random() * (window.innerHeight - 100); // 確保不超出視窗
        bubble.style.left = `${x}px`;
        bubble.style.top = `${y}px`;

        container.appendChild(bubble);

        // 動畫結束後移除對話框
        bubble.addEventListener("animationend", () => {
            bubble.remove();
        });

        // 每個對話框持續4秒
        setTimeout(() => {
            bubble.remove();
        }, 4000);

    }, 800); // 每 0.8 秒生成一個新的對話框

    // 停止生成對話框的條件，可以根據需要進行設置
    setTimeout(() => {
        clearInterval(interval);
    }, 20000); // 20秒後停止生成對話框
}

// 獲取元素
const dinoRight = document.getElementById('brachiosaurus-right');
const dinoLeft = document.getElementById('brachiosaurus-left');
const dialog = document.getElementById('dialog');
const closeButton = document.querySelector('.close');

// 點擊事件
[dinoRight, dinoLeft].forEach(dino => {
    dino.addEventListener('click', function() {
        dialog.classList.remove('hidden'); // 顯示對話框
    });
});

// 關閉對話框
closeButton.addEventListener('click', function() {
    dialog.classList.add('hidden'); // 隱藏對話框
});

// 點擊對話框外部關閉
dialog.addEventListener('click', function(e) {
    if (e.target === dialog) {
        dialog.classList.add('hidden'); // 隱藏對話框
    }
});

// 自動關閉對話框
setTimeout(() => {
    dialog.classList.add('hidden');
}, 5000); // 5 秒後自動關閉對話框


// 點擊事件
[dinoRight, dinoLeft].forEach(dino => {
    dino.addEventListener('click', function() {
        dialog.classList.add('visible'); // 顯示對話框
        dialog.classList.remove('hidden'); // 确保它不被隐藏
    });
});

// 關閉對話框
closeButton.addEventListener('click', function() {
    dialog.classList.remove('visible'); // 隐藏对话框
    setTimeout(() => {
        dialog.classList.add('hidden'); // 等待动画结束后隐藏
    }, 300); // 等待时间与 CSS 动画时间相匹配
});


    </script>
</body>
</html>
